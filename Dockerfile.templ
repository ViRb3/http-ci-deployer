FROM {{ .Env.ARCH }}/alpine:3.11
ENV SRC_BINARY="dist/{{ .Env.DRONE_REPO_NAME }}_{{ .Env.DIST_NAME }}/{{ .Env.DRONE_REPO_NAME }}"
ENV DEST_BINARY="/{{ .Env.DRONE_REPO_NAME }}"

WORKDIR /

COPY "$SRC_BINARY" "$DEST_BINARY"

ENV GIN_MODE=release
ENTRYPOINT ["$DEST_BINARY", "--port", "8080"]
EXPOSE 8080
